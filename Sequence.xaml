< Activity mc:Ignorable="sap sap2010" x:Class="Main" VisualBasic.Settings="{x:Null}" sap2010:WorkflowViewState.IdRef="ActivityBuilder_1" xmlns="http://schemas.microsoft.com/netfx/2009/xaml/activities" xmlns:av="http://schemas.microsoft.com/winfx/2006/xaml/presentation" xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" xmlns:mva="clr-namespace:Microsoft.VisualBasic.Activities;assembly=System.Activities" xmlns:scg="clr-namespace:System.Collections.Generic;assembly=mscorlib" xmlns:sco="clr-namespace:System.Collections.ObjectModel;assembly=mscorlib" xmlns:sap="http://schemas.microsoft.com/netfx/2009/xaml/activities/presentation" xmlns:sap2010="http://schemas.microsoft.com/netfx/2010/xaml/activities/presentation" xmlns:ui="http://schemas.uipath.com/workflow/activities" xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml">
  <TextExpression.NamespacesForImplementation>
    <sco:Collection x:TypeArguments="x:String">
      <x:String>System.Activities</x:String>
      <x:String>System.Activities.Statements</x:String>
      <x:String>System.Activities.Expressions</x:String>
      <x:String>System.Activities.Validation</x:String>
      <x:String>System.Activities.XamlIntegration</x:String>
      <x:String>Microsoft.VisualBasic</x:String>
      <x:String>Microsoft.VisualBasic.Activities</x:String>
      <x:String>System</x:String>
      <x:String>System.Collections</x:String>
      <x:String>System.Collections.Generic</x:String>
      <x:String>System.Collections.ObjectModel</x:String>
      <x:String>System.Data</x:String>
      <x:String>System.Diagnostics</x:String>
      <x:String>System.Drawing</x:String>
      <x:String>System.IO</x:String>
      <x:String>System.Linq</x:String>
      <x:String>System.Net.Mail</x:String>
      <x:String>System.Xml</x:String>
      <x:String>System.Xml.Linq</x:String>
      <x:String>UiPath.Core</x:String>
      <x:String>UiPath.Core.Activities</x:String>
      <x:String>System.Windows.Markup</x:String>
      <x:String>GlobalVariablesNamespace</x:String>
      <x:String>GlobalConstantsNamespace</x:String>
      <x:String>System.Linq.Expressions</x:String>
      <x:String>System.Runtime.Serialization</x:String>
    </sco:Collection>
  </TextExpression.NamespacesForImplementation>
  <TextExpression.ReferencesForImplementation>
    <sco:Collection x:TypeArguments="AssemblyReference">
      <AssemblyReference>Microsoft.VisualBasic</AssemblyReference>
      <AssemblyReference>mscorlib</AssemblyReference>
      <AssemblyReference>PresentationCore</AssemblyReference>
      <AssemblyReference>PresentationFramework</AssemblyReference>
      <AssemblyReference>System</AssemblyReference>
      <AssemblyReference>System.Activities</AssemblyReference>
      <AssemblyReference>System.ComponentModel.TypeConverter</AssemblyReference>
      <AssemblyReference>System.Core</AssemblyReference>
      <AssemblyReference>System.Data</AssemblyReference>
      <AssemblyReference>System.Data.Common</AssemblyReference>
      <AssemblyReference>System.Data.DataSetExtensions</AssemblyReference>
      <AssemblyReference>System.Drawing</AssemblyReference>
      <AssemblyReference>System.Drawing.Common</AssemblyReference>
      <AssemblyReference>System.Drawing.Primitives</AssemblyReference>
      <AssemblyReference>System.Linq</AssemblyReference>
      <AssemblyReference>System.Net.Mail</AssemblyReference>
      <AssemblyReference>System.ObjectModel</AssemblyReference>
      <AssemblyReference>System.Private.CoreLib</AssemblyReference>
      <AssemblyReference>System.Xaml</AssemblyReference>
      <AssemblyReference>System.Xml</AssemblyReference>
      <AssemblyReference>System.Xml.Linq</AssemblyReference>
      <AssemblyReference>UiPath.System.Activities</AssemblyReference>
      <AssemblyReference>UiPath.UiAutomation.Activities</AssemblyReference>
      <AssemblyReference>WindowsBase</AssemblyReference>
      <AssemblyReference>UiPath.Studio.Constants</AssemblyReference>
      <AssemblyReference>System.Console</AssemblyReference>
      <AssemblyReference>System.Security.Permissions</AssemblyReference>
      <AssemblyReference>System.Configuration.ConfigurationManager</AssemblyReference>
      <AssemblyReference>System.ComponentModel</AssemblyReference>
      <AssemblyReference>System.Memory</AssemblyReference>
      <AssemblyReference>System.Private.Uri</AssemblyReference>
      <AssemblyReference>System.Linq.Expressions</AssemblyReference>
      <AssemblyReference>System.Private.ServiceModel</AssemblyReference>
      <AssemblyReference>System.Private.DataContractSerialization</AssemblyReference>
      <AssemblyReference>System.Runtime.Serialization.Formatters</AssemblyReference>
      <AssemblyReference>System.Runtime.Serialization.Primitives</AssemblyReference>
    </sco:Collection>
  </TextExpression.ReferencesForImplementation>

  <Sequence DisplayName="Main Sequence" sap:VirtualizedContainerService.HintSize="644.6666666666666,495.65666666666664" sap2010:WorkflowViewState.IdRef="Sequence_1">
    <sap:WorkflowViewStateService.ViewState>
      <scg:Dictionary x:TypeArguments="x:String, x:Object">
        <x:Boolean x:Key="IsExpanded">True</x:Boolean>
      </scg:Dictionary>
    </sap:WorkflowViewStateService.ViewState>

    <!-- Variables -->
    <Sequence.Variables>
      <Variable x:TypeArguments="x:String" Name="productName" />
    </Sequence.Variables>

    <!-- Open Flipkart in browser -->
    <ui:OpenBrowser DisplayName="Open Flipkart" Url="https://www.flipkart.com" BrowserType="Chrome" sap:VirtualizedContainerService.HintSize="600,300">
      <ui:OpenBrowser.Body>
        <ActivityAction x:TypeArguments="ui:Browser" mva:VisualBasic.Settings="{}">
          <ActivityAction.Argument>
            <DelegateInArgument x:TypeArguments="ui:Browser" Name="browser" />
          </ActivityAction.Argument>
          <ActivityAction.Body>
            <Sequence DisplayName="Flipkart Flow" sap:VirtualizedContainerService.HintSize="600,400">

              <!-- Ask user for product name -->
              <ui:InputDialog DisplayName="Ask product to search" Title="Search product" Label="Please enter the product name to search on Flipkart:" Result="[productName]" sap:VirtualizedContainerService.HintSize="350,140" />

              <!-- Give the page a moment to be ready -->
              <ui:Delay DisplayName="Wait for page load" Duration="00:00:03" sap:VirtualizedContainerService.HintSize="200,50" />

              <!-- Click search box (adjust selector in UI Explorer if necessary) -->
              <ui:Click DisplayName="Click Search Box" ClickType="CLICK_SINGLE" DelayBefore="00:00:00" DelayAfter="00:00:00" ContinueOnError="False" sap:VirtualizedContainerService.HintSize="300,80">
                <ui:Click.Target>
                  <ui:Target>
                    <!-- Example selector for Flipkart search input; validate and refine in UiPath Studio -->
                    <ui:Selector>&lt;html title='Flipkart' /&gt;&lt;webctrl tag='INPUT' type='text' name='q' /&gt;</ui:Selector>
                  </ui:Target>
                </ui:Click.Target>
              </ui:Click>

              <!-- Type the product name -->
              <ui:TypeInto DisplayName="Type product name" DelayBetweenKeys="0" EmptyField="True" sap:VirtualizedContainerService.HintSize="400,80">
                <ui:TypeInto.Text>
                  <InArgument x:TypeArguments="x:String">[productName]</InArgument>
                </ui:TypeInto.Text>
                <ui:TypeInto.Target>
                  <ui:Target>
                    <!-- Same selector as Click; ensure it's accurate -->
                    <ui:Selector>&lt;html title='Flipkart' /&gt;&lt;webctrl tag='INPUT' type='text' name='q' /&gt;</ui:Selector>
                  </ui:Target>
                </ui:TypeInto.Target>
              </ui:TypeInto>

              <!-- Press Enter to search -->
              <ui:SendHotkey DisplayName="Press Enter" Key="enter" sap:VirtualizedContainerService.HintSize="200,80">
                <ui:SendHotkey.Target>
                  <ui:Target>
                    <ui:Selector>&lt;html title='Flipkart' /&gt;&lt;webctrl tag='INPUT' type='text' name='q' /&gt;</ui:Selector>
                  </ui:Target>
                </ui:SendHotkey.Target>
              </ui:SendHotkey>

              <!-- Optional: Show a messagebox confirming the search term -->
              <ui:MessageBox DisplayName="Show Confirmation" sap:VirtualizedContainerService.HintSize="300,80">
                <ui:MessageBox.Text>
                  <InArgument x:TypeArguments="x:String">"Searching Flipkart for: " &amp; productName</InArgument>
                </ui:MessageBox.Text>
              </ui:MessageBox>

            </Sequence>
          </ActivityAction.Body>
        </ActivityAction>
      </ui:OpenBrowser.Body>
    </ui:OpenBrowser>

  </Sequence>
</Activity>
